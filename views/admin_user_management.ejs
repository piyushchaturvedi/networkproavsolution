<%- include('_header', { pageTitle: pageTitle, activePage: 'users' }) %>

<style>
  /* ... existing styles ... */
  
  .user-table .action-links .block-link,
  .user-table .action-links .unblock-link {
    display: inline-block;
    padding: 6px 12px;
    margin-right: 8px;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    cursor: pointer;
    border: none;
    transition: background-color 0.2s ease;
  }
  .user-table .action-links .block-link {
    background-color: #dc3545; /* Red */
    color: white;
  }
  .user-table .action-links .block-link:hover {
    background-color: #c82333;
  }
  .user-table .action-links .unblock-link {
    background-color: #28a745; /* Green */
    color: white;
  }
  .user-table .action-links .unblock-link:hover {
    background-color: #218838;
  }

  /* ... existing responsive styles ... */
</style>

<div class="user-management-dashboard">
  <h1>User Management</h1>
  <% if (message) { %>
    <p class="message"><%= message %></p>
  <% } %>
  <% if (error) { %>
    <p class="error-message"><%= error %></p>
  <% } %>

  <table class="user-table">
    <thead>
      <tr>
        <th>Username</th>
        <th>Full Name</th> <!-- NEW COLUMN -->
        <th>Email</th>
        <th>Role</th>
        <th>Status</th> <!-- NEW COLUMN -->
        <th>Created At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% users.forEach(user => { %>
        <tr>
          <td data-label="Username"><%= user.username %></td>
          <td data-label="Full Name"><%= user.fullName || 'N/A' %></td> <!-- NEW COLUMN -->
          <td data-label="Email"><%= user.email %></td>
          <td data-label="Role"><%= user.role %></td>
          <td data-label="Status">
            <span style="color: <%= user.isBlocked ? 'red' : 'green' %>">
              <%= user.isBlocked ? 'Blocked' : 'Active' %>
            </span>
          </td> <!-- NEW COLUMN -->
          <td data-label="Created At"><%= user.createdAt.toLocaleDateString() %></td>
          <td data-label="Actions" class="action-links">
            <form action="/admin/user/toggle-block/<%= user._id %>" method="POST" style="display:inline-block;">
                <% if (user.isBlocked) { %>
                    <button type="submit" class="unblock-link">Unblock</button>
                <% } else { %>
                    <button type="submit" class="block-link">Block</button>
                <% } %>
            </form>
            <!-- Add edit/delete user links here (if desired) -->
            <!-- <a href="#" class="edit-link">Edit</a> -->
          </td>
        </tr>
      <% }); %>
    </tbody>
  </table>
</div>

<%- include('_footer') %>